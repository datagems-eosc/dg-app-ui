#!/bin/sh

echo "ğŸ” Validating commit message..."
echo ""

npx --no -- commitlint --edit $1 --verbose
COMMITLINT_EXIT_CODE=$?

if [ $COMMITLINT_EXIT_CODE -ne 0 ]; then
  echo ""
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo "âŒ COMMIT MESSAGE VALIDATION FAILED"
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
  echo "ğŸ“‹ Required format:"
  echo "   DG-XX | Your commit message"
  echo ""
  echo "ğŸ“Œ Rules:"
  echo "   â€¢ Must start with task number (DG-XX where XX is a number)"
  echo "   â€¢ Followed by a pipe symbol |"
  echo "   â€¢ Then your commit message (minimum 3 characters)"
  echo ""
  echo "âœ… Valid examples:"
  echo "   DG-59 | Add user authentication"
  echo "   DG-123 | Fix dataset loading issue"
  echo "   DG-1 | Update documentation"
  echo "   DG-456 | Refactor API client"
  echo ""
  echo "âŒ Your commit message:"
  cat $1
  echo ""
  echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
  echo ""
  exit 1
fi

echo "âœ… Commit message validated"
echo ""

